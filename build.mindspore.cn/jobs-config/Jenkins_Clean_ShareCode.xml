<?xml version="1.1" encoding="UTF-8" standalone="no"?><project>
  <actions/>
  <description>手动或定时清理共享缓存环境</description>
  <keepDependencies>false</keepDependencies>
  <properties>
    <hudson.plugins.jira.JiraProjectProperty plugin="jira@3.3"/>
    <jenkins.model.BuildDiscarderProperty>
      <strategy class="hudson.tasks.LogRotator">
        <daysToKeep>15</daysToKeep>
        <numToKeep>1000</numToKeep>
        <artifactDaysToKeep>-1</artifactDaysToKeep>
        <artifactNumToKeep>-1</artifactNumToKeep>
      </strategy>
    </jenkins.model.BuildDiscarderProperty>
    <com.gitee.jenkins.connection.GiteeConnectionProperty plugin="gitee@1.2.4">
      <giteeConnection>gitee</giteeConnection>
    </com.gitee.jenkins.connection.GiteeConnectionProperty>
    <com.sonyericsson.rebuild.RebuildSettings plugin="rebuild@1.32">
      <autoRebuild>false</autoRebuild>
      <rebuildDisabled>false</rebuildDisabled>
    </com.sonyericsson.rebuild.RebuildSettings>
    
  </properties>
  <scm class="hudson.scm.NullSCM"/>
  <assignedNode>x86-build-euleros</assignedNode>
  <canRoam>false</canRoam>
  <disabled>false</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <triggers>
    <hudson.triggers.TimerTrigger>
      <spec>H H/3 * * *</spec>
    </hudson.triggers.TimerTrigger>
  </triggers>
  <concurrentBuild>false</concurrentBuild>
  <builders>
    <hudson.tasks.Shell>
      <command>#!/bin/bash

# Usage:
#    Command: sh clear_code.sh

# Init parameter
code_root_path="/home/jenkins/share-data/gitee"

# Clear old building
organization_names=$(ls ${code_root_path})
for oranization_name in ${organization_names}; do
    repo_names=$(ls ${code_root_path}/${oranization_name})
    for repo_name in ${repo_names}; do
        if [ -d ${code_root_path}/${oranization_name}/${repo_name}/code ]; then
            echo -e "\n\e[0;32m[INFO] Clear ${oranization_name}/${repo_name} old building code."
            build_types=$(ls ${code_root_path}/${oranization_name}/${repo_name}/code|grep -E 'daily|gate|version|weekly')
            for build_type in ${build_types}; do
                echo "[INFO] Clear ${oranization_name}/${repo_name}/${build_type}."
                find ${code_root_path}/${oranization_name}/${repo_name}/code/${build_type} -maxdepth 1 -type d -mtime +1|xargs rm -fr
            done

        fi
    done
done</command>
      <configuredLocalRules/>
    </hudson.tasks.Shell>
  </builders>
  <publishers/>
  <buildWrappers>
    <hudson.plugins.ws__cleanup.PreBuildCleanup plugin="ws-cleanup@0.39">
      <deleteDirs>false</deleteDirs>
      <cleanupParameter/>
      <externalDelete/>
      <disableDeferredWipeout>false</disableDeferredWipeout>
    </hudson.plugins.ws__cleanup.PreBuildCleanup>
    <hudson.plugins.timestamper.TimestamperBuildWrapper plugin="timestamper@1.13"/>
    <hudson.plugins.ansicolor.AnsiColorBuildWrapper plugin="ansicolor@1.0.0">
      <colorMapName>xterm</colorMapName>
    </hudson.plugins.ansicolor.AnsiColorBuildWrapper>
  </buildWrappers>
</project>