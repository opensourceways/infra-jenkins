<?xml version='1.1' encoding='UTF-8'?>
<project>
  <actions/>
  <description>pr合入后，将代码同步到obs</description>
  <keepDependencies>false</keepDependencies>
  <properties>
    <com.sonyericsson.jenkins.plugins.bfa.model.ScannerJobProperty plugin="build-failure-analyzer@1.27.1">
      <doNotScan>false</doNotScan>
    </com.sonyericsson.jenkins.plugins.bfa.model.ScannerJobProperty>
    <com.gitee.jenkins.connection.GiteeConnectionProperty plugin="gitee@1.1.12">
      <giteeConnection>Gitee</giteeConnection>
    </com.gitee.jenkins.connection.GiteeConnectionProperty>
    <com.sonyericsson.rebuild.RebuildSettings plugin="rebuild@1.31">
      <autoRebuild>false</autoRebuild>
      <rebuildDisabled>false</rebuildDisabled>
    </com.sonyericsson.rebuild.RebuildSettings>
  </properties>
  <scm class="hudson.scm.NullSCM"/>
  <assignedNode>k8s-x86-obs</assignedNode>
  <canRoam>false</canRoam>
  <disabled>true</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <triggers>
    <org.jenkinsci.plugins.gwt.GenericTrigger plugin="generic-webhook-trigger@1.67">
      <spec></spec>
      <genericVariables>
        <org.jenkinsci.plugins.gwt.GenericVariable>
          <expressionType>JSONPath</expressionType>
          <key>giteeRepoName</key>
          <value>repository.name</value>
          <regexpFilter></regexpFilter>
          <defaultValue></defaultValue>
        </org.jenkinsci.plugins.gwt.GenericVariable>
        <org.jenkinsci.plugins.gwt.GenericVariable>
          <expressionType>JSONPath</expressionType>
          <key>giteePullRequestIid</key>
          <value>pull_request.number</value>
          <regexpFilter></regexpFilter>
          <defaultValue></defaultValue>
        </org.jenkinsci.plugins.gwt.GenericVariable>
        <org.jenkinsci.plugins.gwt.GenericVariable>
          <expressionType>JSONPath</expressionType>
          <key>giteeSourceBranch</key>
          <value>pull_request.head.ref</value>
          <regexpFilter></regexpFilter>
          <defaultValue></defaultValue>
        </org.jenkinsci.plugins.gwt.GenericVariable>
        <org.jenkinsci.plugins.gwt.GenericVariable>
          <expressionType>JSONPath</expressionType>
          <key>giteeTargetBranch</key>
          <value>pull_request.base.ref</value>
          <regexpFilter></regexpFilter>
          <defaultValue></defaultValue>
        </org.jenkinsci.plugins.gwt.GenericVariable>
        <org.jenkinsci.plugins.gwt.GenericVariable>
          <expressionType>JSONPath</expressionType>
          <key>giteeSourceNamespace</key>
          <value>pull_request.head.repo.namespace</value>
          <regexpFilter></regexpFilter>
          <defaultValue></defaultValue>
        </org.jenkinsci.plugins.gwt.GenericVariable>
        <org.jenkinsci.plugins.gwt.GenericVariable>
          <expressionType>JSONPath</expressionType>
          <key>giteeTargetNamespace</key>
          <value>pull_request.base.repo.namespace</value>
          <regexpFilter></regexpFilter>
          <defaultValue></defaultValue>
        </org.jenkinsci.plugins.gwt.GenericVariable>
        <org.jenkinsci.plugins.gwt.GenericVariable>
          <expressionType>JSONPath</expressionType>
          <key>giteeCommitter</key>
          <value>sender.name</value>
          <regexpFilter></regexpFilter>
          <defaultValue></defaultValue>
        </org.jenkinsci.plugins.gwt.GenericVariable>
      </genericVariables>
      <regexpFilterText></regexpFilterText>
      <regexpFilterExpression></regexpFilterExpression>
      <printPostContent>false</printPostContent>
      <printContributedVariables>false</printContributedVariables>
      <causeString>&quot;$giteeRepoName&quot; trigger by pull request $giteePullRequestIid  [$giteeSourceNamespace:$giteeSourceBranch -&gt; $giteeTargetNamespace:$giteeTargetBranch]</causeString>
      <token></token>
      <silentResponse>false</silentResponse>
      <overrideQuietPeriod>false</overrideQuietPeriod>
    </org.jenkinsci.plugins.gwt.GenericTrigger>
  </triggers>
  <concurrentBuild>false</concurrentBuild>
  <builders>
    <hudson.tasks.Shell>
      <command>set +x
# echo &quot;env:  ${giteeRepoName} ${giteeBranch} ${giteePullRequestIid} ${giteeSourceNamespace}&quot;
echo &quot;parallel acl start&quot;

env

# TODO python script run acl
if [ &quot;x$giteeRepoName&quot; = &quot;x&quot; ]; then
	echo &quot;giteeTargetRepoName is empty, quit&quot;
    exit 1
fi

echo &quot;start to judge&quot;
if [ &quot;x$giteeRepoName&quot; = &quot;xci_check&quot; -o \
     &quot;x$giteeRepoName&quot; = &quot;xbuild&quot;  -o \
     &quot;x$giteeRepoName&quot; = &quot;xobs_bin&quot;  -o \
     &quot;x$giteeRepoName&quot; = &quot;xobs_meta&quot; -o \
     &quot;x$giteeRepoName&quot; = &quot;xwebsite&quot;  -o \
     &quot;x$giteeRepoName&quot; = &quot;xcommunity&quot;  -o \
     &quot;x$giteeRepoName&quot; = &quot;xdocs&quot;  -o \
     &quot;x$giteeRepoName&quot; = &quot;xinfrastructure&quot;  -o \
     &quot;x$giteeRepoName&quot; = &quot;xopenEuler-latest-release&quot; ]; then
    exit 0
fi
echo &quot;end to judge&quot;

OBS_SOURCE_IP=&quot;172.16.1.89&quot;
echo &quot;$giteeRepoName $OBS_SOURCE_IP $OBS_SRCNAME $OBS_SRCPWD&quot;
bash -x $AGENT_WORKDIR/../ci_check/job_scripts/sync_pr_to_obs.sh $giteeRepoName $OBS_SOURCE_IP $OBS_SRCNAME $OBS_SRCPWD $giteeTargetBranch
echo &quot;parallel acl end&quot;
set -x
</command>
    </hudson.tasks.Shell>
  </builders>
  <publishers/>
  <buildWrappers>
    <org.jenkinsci.plugins.credentialsbinding.impl.SecretBuildWrapper plugin="credentials-binding@1.23">
      <bindings>
        <org.jenkinsci.plugins.credentialsbinding.impl.UsernamePasswordMultiBinding>
          <credentialsId>be1d7d09-4ab8-44da-ad52-82b3dcc795b0</credentialsId>
          <usernameVariable>OBS_USERNAME</usernameVariable>
          <passwordVariable>OBS_PASSWORD</passwordVariable>
        </org.jenkinsci.plugins.credentialsbinding.impl.UsernamePasswordMultiBinding>
        <org.jenkinsci.plugins.credentialsbinding.impl.UsernamePasswordMultiBinding>
          <credentialsId>a1893593-4d91-4950-b399-c063edc9aad9</credentialsId>
          <usernameVariable>OBS_SRCNAME</usernameVariable>
          <passwordVariable>OBS_SRCPWD</passwordVariable>
        </org.jenkinsci.plugins.credentialsbinding.impl.UsernamePasswordMultiBinding>
      </bindings>
    </org.jenkinsci.plugins.credentialsbinding.impl.SecretBuildWrapper>
    <hudson.plugins.ansicolor.AnsiColorBuildWrapper plugin="ansicolor@0.7.1">
      <colorMapName>xterm</colorMapName>
    </hudson.plugins.ansicolor.AnsiColorBuildWrapper>
  </buildWrappers>
</project>